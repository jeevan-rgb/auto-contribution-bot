name: Daily Contribution

permissions:
  contents: write  # Lets GITHUB_TOKEN push

on:
  schedule:
    - cron: '0 7 * * *'  # 07:00 UTC ≈ 12:30 PM IST
  workflow_dispatch:

jobs:
  auto-contribute:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Random delay (looks more human)
        run: sleep $((RANDOM % 7200 + 300))  # 5 min to 2 hr — avoids perfect timing

      - name: Daily commit in IST
        run: |
          export TZ=Asia/Kolkata
          
          # Add timestamped line so file always changes
          echo "Daily auto update: $(date '+%Y-%m-%d %H:%M:%S %Z')" >> log.txt
          
          # Use your real details (fix typo: SARAKR → SARKAR ?)
          git config user.name "Naboraj Sarkar"
          git config user.email "nishant.ns.business@gmail.com"
          
          git add log.txt
          
          # Commit only if changes exist
          git diff --staged --quiet || git commit -m "chore: daily auto contribution $(date '+%Y-%m-%d')"
          
          # Push (should work with token)
          git push origin HEAD
